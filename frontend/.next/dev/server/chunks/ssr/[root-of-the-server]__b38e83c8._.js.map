{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/frontend/lib/directus.ts"],"sourcesContent":["import { createDirectus, rest, staticToken } from '@directus/sdk';\n\n// Use /api instead of localhost:8055 - goes through Next.js proxy\nconst directus = createDirectus(process.env.NEXT_PUBLIC_DIRECTUS_URL || 'http://localhost:5000')\n    .with(process.env.NEXT_PUBLIC_DIRECTUS_TOKEN ? staticToken(process.env.NEXT_PUBLIC_DIRECTUS_TOKEN) : (client) => client)\n    .with(rest());\n\nexport default directus;\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AAAA;;AAEA,kEAAkE;AAClE,MAAM,WAAW,IAAA,qKAAc,EAAC,6DAAwC,yBACnE,IAAI,CAAC,QAAQ,GAAG,CAAC,0BAA0B,GAAG,IAAA,0KAAW,EAAC,QAAQ,GAAG,CAAC,0BAA0B,IAAI,CAAC,SAAW,QAChH,IAAI,CAAC,IAAA,uKAAI;uCAEC"}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/frontend/app/actu/page.tsx"],"sourcesContent":["import Link from 'next/link';\nimport directus from '@/lib/directus';\nimport { readItems } from '@directus/sdk';\n\ntype Post = {\n  id: number;\n  title: string;\n  slug: string;\n  excerpt?: string | null;\n  content?: string | null;\n  published_at?: string | null;\n  status?: string | null;\n  category?: string | number | null;\n  featured_picture?: string | null;\n  seo?: any;\n};\n\nexport const revalidate = 300; // revalidate every 5 minutes\n\nasync function fetchPosts(): Promise<Post[]> {\n  try {\n    const posts = await directus.request(\n      readItems('posts', {\n        fields: [\n          'id',\n          'title',\n          'slug',\n          'excerpt',\n          'content',\n          'published_at',\n          'status',\n          'category',\n          'featured_picture',\n          'seo',\n        ],\n        filter: { status: { _eq: 'published' } },\n        sort: ['-published_at'],\n      })\n    );\n    return (posts as Post[]) || [];\n  } catch (e) {\n    console.warn('Failed to fetch posts', e);\n    return [];\n  }\n}\n\nfunction formatDate(dateStr?: string | null) {\n  if (!dateStr) return '';\n  return new Intl.DateTimeFormat('fr-FR', { day: '2-digit', month: 'long', year: 'numeric' }).format(new Date(dateStr));\n}\n\nfunction getAssetUrl(fileId?: string | null) {\n  if (!fileId) return null;\n  return `/assets/${fileId}`;\n}\n\nexport default async function ActuPage() {\n  const posts = await fetchPosts();\n  const hasPosts = posts.length > 0;\n\n  return (\n    <>\n      <section className=\"page-header\">\n        <div className=\"container\">\n          <h1 className=\"page-title\">Actualités</h1>\n          <p className=\"page-subtitle\">Les dernières nouvelles de Volontaires français</p>\n        </div>\n      </section>\n\n      <section className=\"news\">\n        <div className=\"container\">\n          {!hasPosts && <p>Aucun article publié pour le moment.</p>}\n          {hasPosts &&\n            posts.map((post) => {\n              const date = post.published_at;\n              const preview = post.excerpt || (post.content ? `${post.content.slice(0, 220)}…` : '');\n              const image = getAssetUrl(post.featured_picture);\n              return (\n                <article className=\"news-article\" key={post.id}>\n                  <div className=\"article-header\">\n                    <h2 className=\"article-title\">\n                      <Link href={`/actu/${post.slug}`}>{post.title}</Link>\n                    </h2>\n                    {date && (\n                      <p className=\"article-date\">\n                        <i className=\"far fa-calendar\" /> {formatDate(date)}\n                      </p>\n                    )}\n                  </div>\n                  <div className=\"article-content\">\n                    {image && (\n                      <div className=\"article-image\">\n                        <img src={image} alt={post.title} style={{ width: '100%', borderRadius: '8px', marginBottom: '16px' }} />\n                      </div>\n                    )}\n                    {preview && <div className=\"article-preview\" dangerouslySetInnerHTML={{ __html: preview }} />}\n                    <Link\n                      href={`/actu/${post.slug}`}\n                      className=\"btn-read-more\"\n                      style={{ display: 'inline-flex', alignItems: 'center', gap: '6px' }}\n                    >\n                      Lire l’article <i className=\"fas fa-chevron-right\"></i>\n                    </Link>\n                  </div>\n                </article>\n              );\n            })}\n        </div>\n      </section>\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AAAA;;;;;AAeO,MAAM,aAAa,KAAK,6BAA6B;AAE5D,eAAe;IACb,IAAI;QACF,MAAM,QAAQ,MAAM,0HAAQ,CAAC,OAAO,CAClC,IAAA,2LAAS,EAAC,SAAS;YACjB,QAAQ;gBACN;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;aACD;YACD,QAAQ;gBAAE,QAAQ;oBAAE,KAAK;gBAAY;YAAE;YACvC,MAAM;gBAAC;aAAgB;QACzB;QAEF,OAAO,AAAC,SAAoB,EAAE;IAChC,EAAE,OAAO,GAAG;QACV,QAAQ,IAAI,CAAC,yBAAyB;QACtC,OAAO,EAAE;IACX;AACF;AAEA,SAAS,WAAW,OAAuB;IACzC,IAAI,CAAC,SAAS,OAAO;IACrB,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;QAAE,KAAK;QAAW,OAAO;QAAQ,MAAM;IAAU,GAAG,MAAM,CAAC,IAAI,KAAK;AAC9G;AAEA,SAAS,YAAY,MAAsB;IACzC,IAAI,CAAC,QAAQ,OAAO;IACpB,OAAO,CAAC,QAAQ,EAAE,QAAQ;AAC5B;AAEe,eAAe;IAC5B,MAAM,QAAQ,MAAM;IACpB,MAAM,WAAW,MAAM,MAAM,GAAG;IAEhC,qBACE;;0BACE,8OAAC;gBAAQ,WAAU;0BACjB,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAa;;;;;;sCAC3B,8OAAC;4BAAE,WAAU;sCAAgB;;;;;;;;;;;;;;;;;0BAIjC,8OAAC;gBAAQ,WAAU;0BACjB,cAAA,8OAAC;oBAAI,WAAU;;wBACZ,CAAC,0BAAY,8OAAC;sCAAE;;;;;;wBAChB,YACC,MAAM,GAAG,CAAC,CAAC;4BACT,MAAM,OAAO,KAAK,YAAY;4BAC9B,MAAM,UAAU,KAAK,OAAO,IAAI,CAAC,KAAK,OAAO,GAAG,GAAG,KAAK,OAAO,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,EAAE;4BACrF,MAAM,QAAQ,YAAY,KAAK,gBAAgB;4BAC/C,qBACE,8OAAC;gCAAQ,WAAU;;kDACjB,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAG,WAAU;0DACZ,cAAA,8OAAC,0LAAI;oDAAC,MAAM,CAAC,MAAM,EAAE,KAAK,IAAI,EAAE;8DAAG,KAAK,KAAK;;;;;;;;;;;4CAE9C,sBACC,8OAAC;gDAAE,WAAU;;kEACX,8OAAC;wDAAE,WAAU;;;;;;oDAAoB;oDAAE,WAAW;;;;;;;;;;;;;kDAIpD,8OAAC;wCAAI,WAAU;;4CACZ,uBACC,8OAAC;gDAAI,WAAU;0DACb,cAAA,8OAAC;oDAAI,KAAK;oDAAO,KAAK,KAAK,KAAK;oDAAE,OAAO;wDAAE,OAAO;wDAAQ,cAAc;wDAAO,cAAc;oDAAO;;;;;;;;;;;4CAGvG,yBAAW,8OAAC;gDAAI,WAAU;gDAAkB,yBAAyB;oDAAE,QAAQ;gDAAQ;;;;;;0DACxF,8OAAC,0LAAI;gDACH,MAAM,CAAC,MAAM,EAAE,KAAK,IAAI,EAAE;gDAC1B,WAAU;gDACV,OAAO;oDAAE,SAAS;oDAAe,YAAY;oDAAU,KAAK;gDAAM;;oDACnE;kEACgB,8OAAC;wDAAE,WAAU;;;;;;;;;;;;;;;;;;;+BAvBK,KAAK,EAAE;;;;;wBA4BlD;;;;;;;;;;;;;;AAKZ"}}]
}